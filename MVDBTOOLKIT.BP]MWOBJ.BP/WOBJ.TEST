**********************************************************************
*
* Copyright (C) 2017 Zumasys, Inc., All Rights Reserved
*
* Written by: Patrick Payne, Zumasys
* Date: December 2017
* Description: WOBJ.TEST - QC Testing tool for WOBJ
*
**********************************************************************
*
* Build test json to parse
*
JSON =  \{\
JSON := \ "stringtest":"stringtestvalue",\
JSON := \ "numbertest": 100.12,\
JSON := \ "booleantesttrue": True, \
JSON := \ "booleantestfalse": False, \
JSON := \}\
*
* TEST1 - PARSE JSON
TEST="PARSEJSON"
GOSUB start.test
CALL WOBJ(TESTOBJ,"FROMSTRING","",JSON,"",RERR)
IF RERR<1> THEN
   TEST.STATUS=0
   TEST.MSG=RERR<2>
END ELSE
    TEST.STATUS=1
    TEST.MSG="Parsed OK"
END
GOSUB end.test
IF RERR<1> THEN STOP
*
* TEST 2 - GetString
*
TEST="GetString"
GOSUB start.test
CALL WOBJ(TESTOBJ,"GET","stringtest",VALUE,"",RERR)
GOSUB process.error
IF NOT(RERR<1>) THEN
   TEST.MSG="String Found: (":VALUE:")"
   IF VALUE="stringtestvalue" THEN
      TEST.STATUS=1
   END ELSE
       TEST.STATUS=0
   END
END
GOSUB end.test
*
* TEST 3 - GetNumber
*
TEST="GetNumber"
GOSUB start.test
CALL WOBJ(TESTOBJ,"GET","numbertest",VALUE,"",RERR)
GOSUB process.error
IF NOT(RERR<1>) THEN
   TEST.MSG="Number Found: (":VALUE:")"
   BEGIN CASE
      CASE NOT(NUM(VALUE))
      CASE VALUE=100.12
      	TEST.STATUS=1
      CASE 1
   END CASE
END
GOSUB end.test
STOP
*
GOSUB start.test
RETURN
*
process.error: *
IF RERR<1> THEN
   TEST.STATUS=-1
   TEST.MSG=RERR<1>
END
RETURN
*
*
start.test: *
TEST.STATUS=0
TEST.MSG="Success"
PRINT "Test: ":TEST[1,20]"L(#20)":
RETURN
*
end.test: *
PRINT "  ":TEST.MSG[1,60]"L(#60)":
PRINT " ":
IF TEST.STATUS THEN PRINT "[Ok    ]" ELSE PRINT @(-13):"[Failed]":@(-14)
RETURN

